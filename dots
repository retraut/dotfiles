#!/usr/bin/env bash
set -e 

DOTFILES="${HOME}/.dotfiles"
FILES="${HOME}/.dotfiles/files"
GIT_REPO_URL="https://github.com/retraut/dotfiles.git"

function cloneGitRepo() {
    
    mkdir -p $DOTFILES
    git clone $GIT_REPO_URL $DOTFILES
}

function installSymlinks() {

    local LINKS=($(find $FILES -maxdepth 1 | awk -F "." '{print $3}'))
	for i in "${LINKS[@]}"; do
		rm -rf ${HOME}/.$i
		if ln -s $FILES/$i ${HOME}/.$i; then
			echo Link to ${HOME}/$i created!
		fi
	done
    echo "installSymlinks is done"
}

function gitsubmoduleUpdate() {

	cd $DOTFILES
	git submodule init
	git submodule update
}

function installVimPackages() {

	vim +PluginInstall +qall
}

function install() {

    cloneGitRepo
	installSymlinks
	gitsubmoduleUpdate
	installVimPackages
}
case "$1" in

install)
	install
	;;
*)
	echo $"Usage: $0 {install|clean|help|status}"
	exit 1

	;;
esac
